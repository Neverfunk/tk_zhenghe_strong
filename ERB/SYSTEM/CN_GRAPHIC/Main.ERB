@CN_INITIALIZE
#DIM _CNT

_CNT = 0;"[青:0][紫:1][赤:2][黄:3][緑:4][水:5][白:6][黒:7][灰:8]"
	CN_DEFAULT_CM:_CNT:0:0 = 256,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,256,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,256,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 1;"紫"
	CN_DEFAULT_CM:_CNT:0:0 = 196,196,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,196,196,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 = 196,  0,196,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 2;"赤"
	CN_DEFAULT_CM:_CNT:0:0 =   0,256,  0,  0,  0
	CN_DEFAULT_CM:_CNT:1:0 =   0,  0,256,  0,  0
	CN_DEFAULT_CM:_CNT:2:0 = 256,  0,  0,  0,  0
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256
_CNT = 3;"黄"
	CN_DEFAULT_CM:_CNT:0:0 =   0,196,196,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 196,  0,196,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 196,196,  0,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;
_CNT = 4;"緑"
	CN_DEFAULT_CM:_CNT:0:0 =   0,  0,256,  0,  0
	CN_DEFAULT_CM:_CNT:1:0 = 256,  0,  0,  0,  0
	CN_DEFAULT_CM:_CNT:2:0 =   0,256,  0,  0,  0
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256
_CNT = 5;"水"
	CN_DEFAULT_CM:_CNT:0:0 = 196,  0,196,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 196,196,  0,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 =   0,196,196,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;
_CNT = 6;"白"//元絵が青一色だから
	CN_DEFAULT_CM:_CNT:0:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;
_CNT = 7;"灰"
	CN_DEFAULT_CM:_CNT:0:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 = -64,-64,-64,  0,256;
_CNT = 8;"黒"
	CN_DEFAULT_CM:_CNT:0:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 128,128,128,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 = -128,-128,-128,  0,256;

;追加色
_CNT = 11;"[栗:11][桃:12][橙:13]"
	CN_DEFAULT_CM:_CNT:0:0 =  56, 30,  6,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 =  56, 30,  6,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 =  56, 30,  6,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;
_CNT = 12;"桃"
	CN_DEFAULT_CM:_CNT:0:0 = 126, 58, 76,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 126, 58, 76,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 126, 58, 76,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0
	CN_DEFAULT_CM:_CNT:4:0 =   3,  3,  3,  0,256
_CNT = 13;"橙"
	CN_DEFAULT_CM:_CNT:0:0 = 128, 71,  0,  0,  0;
	CN_DEFAULT_CM:_CNT:1:0 = 128, 71,  0,  0,  0;
	CN_DEFAULT_CM:_CNT:2:0 = 128, 71,  0,  0,  0;
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256

_CNT = 31;"[普通:31][褐色:32][黄色:33][日焼:34][不健康:35][悪魔:36]"
	CN_DEFAULT_CM:_CNT:0:0 = 256,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,256,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,256,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 32;"褐色" (0.9, 0.7, 0.7)
	CN_DEFAULT_CM:_CNT:0:0 = 231,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,180,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,180,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 33;"黄色" (1.05, 1.05, 1)
	CN_DEFAULT_CM:_CNT:0:0 = 269,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,269,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,256,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 34;"日焼" (1.2, 0.95, 0.95)
	CN_DEFAULT_CM:_CNT:0:0 = 308,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,244,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,244,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 35;"不健康" (1.2, 1.05, 1.2)
	CN_DEFAULT_CM:_CNT:0:0 = 308,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,269,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,308,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行
_CNT = 36;"悪魔" (0.75, 0.75, 1.5)
	CN_DEFAULT_CM:_CNT:0:0 = 192,  0,  0,  0,  0;R
	CN_DEFAULT_CM:_CNT:1:0 =   0,192,  0,  0,  0;G
	CN_DEFAULT_CM:_CNT:2:0 =   0,  0,384,  0,  0;B
	CN_DEFAULT_CM:_CNT:3:0 =   0,  0,  0,256,  0;A
	CN_DEFAULT_CM:_CNT:4:0 =   0,  0,  0,  0,256;平行

@CN_INITIALIZE_GTARGET(_GTARGET_NAME)
#DIMS _GTARGET_NAME
#DIM _CN_GTARGET

_CN_GTARGET = TOINT(REPLACE(_GTARGET_NAME,"CN_",""))
GCREATE _CN_GTARGET,CN_WIDTH,CN_HEIGHT
SPRITECREATE _GTARGET_NAME, _CN_GTARGET

@CN_REDRAW_CHARACTER(_GTARGET_NAME, _CN_CHARAIMG_STRUCT)
#DIMS _GTARGET_NAME
#DIM _GTARGET
#DIMS _CN_CHARAIMG_STRUCT
#DIMS _CN_CHARAIMG_FILELIST
#DIMS _SPRITENAME_TOKEN,10
#DIM _CNT
#DIMS _COLORNAME
#DIM COLORINT
#DIMS _SPRITE

_GTARGET = TOINT(REPLACE(_GTARGET_NAME,"CN_",""))
IF (!GCREATED(_GTARGET))
	THROW 未作成のGrahpicsが指定された:_GTARGET == {_GTARGET}
ENDIF
_CN_DRAW_CHARASPRITE_COUNT = 0
CALL DIC_FOREACH(_CN_CHARAIMG_STRUCT, "CN_FE_CHARACTER_SPRITE_LIST")

_CN_DRAW_CHARASPRITE_NAME:_CN_DRAW_CHARASPRITE_COUNT '= ""
_CN_DRAW_CHARASPRITE_DEPTH:_CN_DRAW_CHARASPRITE_COUNT = 0
ARRAYMSORT _CN_DRAW_CHARASPRITE_DEPTH, _CN_DRAW_CHARASPRITE_NAME

GCLEAR _GTARGET, 0x00000000
FOR _CNT,0,_CN_DRAW_CHARASPRITE_COUNT
	_SPRITE '= _CN_DRAW_CHARASPRITE_NAME:_CNT
	
	IF !SPRITECREATED(_SPRITE)
		CONTINUE
	ENDIF

	SPLIT _SPRITE, "_", _SPRITENAME_TOKEN
	IF (RESULT > 1 && _SPRITENAME_TOKEN:1 != "無")
		_COLORNAME '= DIC_GET(_CN_CHARAIMG_STRUCT, _SPRITENAME_TOKEN:1 +"色")
		IF (_COLORNAME != "")
			COLORINT = TOINT(DIC_GET(CN_COLORMATRIX_DIC, _COLORNAME))
			GDRAWSPRITE _GTARGET, _SPRITE, 0, 0, SPRITEWIDTH(_SPRITE), SPRITEHEIGHT(_SPRITE), CN_DEFAULT_CM:COLORINT:0:0
			CONTINUE 
		ENDIF
	ENDIF
	GDRAWSPRITE _GTARGET, _SPRITE
NEXT

@CN_FE_CHARACTER_SPRITE_LIST(_KEY, _VALUE)
#DIMS _KEY
#DIMS _VALUE
#DIM _SUBKEY = 0
#DIMS _FILELIST
#DIM _CNT
#DIMS _TOKENS,100
IF (STRLENS(_KEY) < 2)
	THROW データ異常
ELSEIF (SUBSTRINGU(_KEY, 1, 1) == "色")
	RETURN
ENDIF
_SUBKEY = 0
IF (STRLENS(_KEY) > 2)
	_SUBKEY = TOINT(SUBSTRINGU(_KEY, 2, -1))
ENDIF

_FILELIST '= DIC_GET(CN_DICTIONARY_RESOURCES, _VALUE)
SPLIT _FILELIST, ",", _TOKENS
FOR _CNT,0,RESULT
	IF (_TOKENS:_CNT == "")
		CONTINUE
	ENDIF
	_CN_DRAW_CHARASPRITE_NAME:_CN_DRAW_CHARASPRITE_COUNT '= _TOKENS:_CNT
	_CN_DRAW_CHARASPRITE_DEPTH:_CN_DRAW_CHARASPRITE_COUNT = -(100 + TOINT(SUBSTRINGU(_TOKENS:_CNT, 2, 2))*100 + (_SUBKEY + 1))
	_CN_DRAW_CHARASPRITE_COUNT++
NEXT
